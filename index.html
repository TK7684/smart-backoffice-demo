<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <title>AI Smart Backoffice Demo | Google Sheets + AI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
      /* ====== Reset & Base ====== */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: #f5f1e8;
        color: #3e2723;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        padding: 16px;
      }

      /* ====== Layout ====== */
      .app-container {
        width: 100%;
        max-width: 1200px;
        background: linear-gradient(to bottom, #faf8f3, #f5f1e8);
        border-radius: 24px;
        padding: 20px 20px 24px;
        box-shadow: 0 8px 24px rgba(101, 67, 33, 0.15);
        border: 1px solid rgba(139, 115, 85, 0.2);
      }

      .header {
        display: flex;
        justify-content: space-between;
        gap: 16px;
        align-items: center;
        margin-bottom: 20px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .brand-logo {
        width: 40px;
        height: 40px;
        border-radius: 999px;
        background: linear-gradient(135deg, #8b7355, #6b5d4f, #8b7355);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #faf8f3;
        font-weight: 800;
        font-size: 20px;
        box-shadow: 0 2px 8px rgba(101, 67, 33, 0.2);
      }

      .brand-title {
        font-size: 18px;
        font-weight: 700;
        color: #5d4037;
      }

      .brand-subtitle {
        font-size: 12px;
        color: #8b7355;
      }

      .pill {
        border-radius: 999px;
        border: 1px solid rgba(139, 115, 85, 0.4);
        padding: 6px 12px;
        font-size: 12px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        color: #5d4037;
        background: rgba(255, 255, 255, 0.6);
      }

      .pill-dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: #689f38;
        box-shadow: 0 0 6px rgba(104, 159, 56, 0.5);
      }

      /* ====== Controls ====== */
      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-bottom: 16px;
      }

      .segment {
        background: rgba(255, 255, 255, 0.6);
        border-radius: 999px;
        padding: 4px;
        display: inline-flex;
        gap: 4px;
        border: 1px solid rgba(139, 115, 85, 0.4);
      }

      .segment button {
        border: none;
        border-radius: 999px;
        padding: 6px 12px;
        font-size: 12px;
        background: transparent;
        color: #8b7355;
        cursor: pointer;
        transition: all 0.15s ease;
      }

      .segment button.active {
        background: linear-gradient(to right, #8b7355, #6b5d4f);
        color: #faf8f3;
        font-weight: 600;
      }

      .badge {
        padding: 4px 8px;
        border-radius: 999px;
        font-size: 11px;
        border: 1px solid rgba(139, 115, 85, 0.5);
        color: #5d4037;
        background: rgba(255, 255, 255, 0.5);
      }

      .btn-template-badge {
        padding: 8px 16px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 115, 85, 0.5);
        color: #5d4037;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(250, 248, 243, 0.9));
        cursor: pointer;
        font-weight: 600;
        transition: all 0.2s ease;
        box-shadow: 0 2px 6px rgba(101, 67, 33, 0.1);
      }

      .btn-template-badge:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(101, 67, 33, 0.2);
        background: linear-gradient(135deg, rgba(255, 255, 255, 1), rgba(250, 248, 243, 1));
      }

      /* ====== Modal ====== */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .modal-overlay.active {
        display: flex;
      }

      .modal {
        background: #faf8f3;
        border-radius: 20px;
        padding: 24px;
        max-width: 600px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(139, 115, 85, 0.3);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 12px;
        border-bottom: 1px solid rgba(139, 115, 85, 0.2);
      }

      .modal-title {
        font-size: 18px;
        font-weight: 700;
        color: #5d4037;
      }

      .modal-close {
        background: none;
        border: none;
        font-size: 24px;
        color: #8b7355;
        cursor: pointer;
        padding: 0;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: all 0.2s ease;
      }

      .modal-close:hover {
        background: rgba(139, 115, 85, 0.1);
        color: #5d4037;
      }

      .form-group {
        margin-bottom: 16px;
      }

      .form-label {
        display: block;
        font-size: 13px;
        font-weight: 600;
        color: #5d4037;
        margin-bottom: 6px;
      }

      .form-input {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        background: rgba(255, 255, 255, 0.9);
        font-size: 13px;
        color: #3e2723;
        transition: all 0.2s ease;
      }

      .form-input:focus {
        outline: none;
        border-color: #8b7355;
        box-shadow: 0 0 0 3px rgba(139, 115, 85, 0.1);
      }

      .form-select {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        background: rgba(255, 255, 255, 0.9);
        font-size: 13px;
        color: #3e2723;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .form-select:focus {
        outline: none;
        border-color: #8b7355;
        box-shadow: 0 0 0 3px rgba(139, 115, 85, 0.1);
      }

      textarea.form-input {
        resize: vertical;
        min-height: 80px;
        font-family: inherit;
      }

      .btn-submit {
        width: 100%;
        padding: 12px;
        border-radius: 12px;
        border: none;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        background: linear-gradient(135deg, #8b7355, #6b5d4f);
        color: #faf8f3;
        transition: all 0.2s ease;
        margin-top: 8px;
      }

      .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(101, 67, 33, 0.3);
      }

      .btn-submit:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      /* Package Selection Styles */
      .package-card {
        background: white;
        border-radius: 16px;
        padding: 20px;
        border: 1px solid rgba(139, 115, 85, 0.2);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
      }

      .package-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(101, 67, 33, 0.15);
      }

      .package-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        color: white;
        font-size: 12px;
        font-weight: 700;
        margin-bottom: 12px;
        text-align: center;
      }

      .package-price {
        font-size: 28px;
        font-weight: 700;
        color: #5d4037;
        margin-bottom: 8px;
      }

      .package-title {
        font-size: 14px;
        font-weight: 600;
        color: #8b7355;
        margin-bottom: 16px;
      }

      .package-features {
        list-style: none;
        padding: 0;
        margin: 0 0 16px 0;
        flex-grow: 1;
      }

      .package-features li {
        padding: 6px 0;
        font-size: 13px;
        color: #5d4037;
        position: relative;
        padding-left: 20px;
      }

      .package-features li:before {
        content: "‚úì";
        position: absolute;
        left: 0;
        color: #689f38;
        font-weight: bold;
      }

      .package-suitable {
        font-size: 12px;
        color: #8b7355;
        font-style: italic;
        margin-bottom: 16px;
        padding-top: 12px;
        border-top: 1px solid rgba(139, 115, 85, 0.1);
      }

      .btn-package-select {
        width: 100%;
        padding: 12px;
        border-radius: 10px;
        border: none;
        background: linear-gradient(135deg, #8b7355, #6b5d4f);
        color: white;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .btn-package-select:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(139, 115, 85, 0.3);
      }

      /* ====== Template Preview ====== */
      .template-preview {
        display: none;
        margin-top: 20px;
        padding: 16px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 12px;
        border: 1px solid rgba(139, 115, 85, 0.2);
      }

      .template-preview.active {
        display: block;
      }

      .template-tabs {
        display: flex;
        gap: 8px;
        margin-bottom: 12px;
        flex-wrap: wrap;
      }

      .template-tab {
        padding: 6px 12px;
        border-radius: 8px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        background: rgba(255, 255, 255, 0.6);
        color: #5d4037;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .template-tab.active {
        background: #8b7355;
        color: #faf8f3;
        border-color: #8b7355;
      }

      .template-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 11px;
        background: white;
        border-radius: 8px;
        overflow: hidden;
      }

      .template-table th {
        background: rgba(139, 115, 85, 0.2);
        padding: 8px;
        text-align: left;
        font-weight: 600;
        color: #5d4037;
        border-bottom: 2px solid rgba(139, 115, 85, 0.3);
      }

      .template-table td {
        padding: 6px 8px;
        border-bottom: 1px solid rgba(139, 115, 85, 0.1);
        color: #3e2723;
      }

      .template-table tr:last-child td {
        border-bottom: none;
      }

      .template-note {
        margin-top: 12px;
        padding: 10px;
        background: rgba(104, 159, 56, 0.1);
        border-radius: 8px;
        border-left: 3px solid #689f38;
        font-size: 12px;
        color: #5d4037;
      }

      /* ====== Grid Layout ====== */
      .grid {
        display: grid;
        grid-template-columns: 2.2fr 1.2fr;
        gap: 16px;
      }

      @media (max-width: 900px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }

      /* ====== Cards ====== */
      .card {
        background: rgba(255, 255, 255, 0.8);
        border-radius: 18px;
        padding: 14px 16px 16px;
        border: 1px solid rgba(139, 115, 85, 0.2);
        box-shadow: 0 2px 8px rgba(101, 67, 33, 0.08);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }

      .card-title {
        font-size: 14px;
        font-weight: 600;
        color: #5d4037;
      }

      .card-subtitle {
        font-size: 11px;
        color: #8b7355;
      }

      .chart-container {
        margin-top: 12px;
        padding: 8px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 12px;
        height: 200px;
        position: relative;
      }

      /* ====== Metrics ====== */
      .metrics-row {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 10px;
        margin-bottom: 12px;
      }

      @media (max-width: 640px) {
        .metrics-row {
          grid-template-columns: 1fr;
        }
      }

      .metric {
        background: linear-gradient(to bottom, rgba(255, 255, 255, 0.9), rgba(250, 248, 243, 0.9));
        border-radius: 14px;
        padding: 10px 12px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        box-shadow: 0 2px 6px rgba(101, 67, 33, 0.1);
      }

      .metric-label {
        font-size: 11px;
        color: #8b7355;
        margin-bottom: 4px;
      }

      .metric-value {
        font-size: 16px;
        font-weight: 700;
        margin-bottom: 3px;
        color: #5d4037;
      }

      .metric-trend {
        font-size: 11px;
      }

      .trend-up {
        color: #689f38;
      }

      .trend-down {
        color: #d84315;
      }

      /* ====== Table ====== */
      .table-wrapper {
        margin-top: 4px;
        border-radius: 12px;
        border: 1px solid rgba(139, 115, 85, 0.2);
        overflow: hidden;
        background: rgba(255, 255, 255, 0.6);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 11px;
      }

      thead {
        background: rgba(139, 115, 85, 0.15);
      }

      th,
      td {
        padding: 6px 8px;
        text-align: left;
      }

      th {
        font-weight: 500;
        color: #5d4037;
        border-bottom: 1px solid rgba(139, 115, 85, 0.3);
      }

      td {
        color: #3e2723;
      }

      tbody tr:nth-child(even) {
        background: rgba(250, 248, 243, 0.5);
      }

      tbody tr:nth-child(odd) {
        background: rgba(255, 255, 255, 0.3);
      }

      tbody tr:hover {
        background: rgba(139, 115, 85, 0.1);
      }

      .status-pill {
        padding: 2px 6px;
        border-radius: 999px;
        font-size: 10px;
        border: 1px solid rgba(139, 115, 85, 0.5);
      }

      .status-done {
        border-color: #689f38;
        color: #558b2f;
        background: rgba(104, 159, 56, 0.1);
      }

      .status-pending {
        border-color: #f57c00;
        color: #e65100;
        background: rgba(245, 124, 0, 0.1);
      }

      /* ====== List ====== */
      .list {
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin-top: 6px;
      }

      .list-item {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        align-items: flex-start;
        padding: 6px 8px;
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(139, 115, 85, 0.2);
      }

      .list-text {
        font-size: 11px;
        color: #3e2723;
      }

      .list-tag {
        font-size: 10px;
        padding: 2px 6px;
        border-radius: 999px;
        border: 1px solid rgba(139, 115, 85, 0.5);
        white-space: nowrap;
        color: #5d4037;
        background: rgba(255, 255, 255, 0.5);
      }

      /* ====== Chat ====== */
      .chat-window {
        background: linear-gradient(to bottom, rgba(255, 255, 255, 0.9), rgba(250, 248, 243, 0.9));
        border-radius: 14px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        padding: 10px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        height: 260px;
        box-shadow: 0 2px 8px rgba(101, 67, 33, 0.1);
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 6px;
        padding-right: 4px;
      }

      .bubble {
        max-width: 78%;
        padding: 6px 8px;
        border-radius: 10px;
        font-size: 11px;
        line-height: 1.35;
      }

      .bubble.user {
        background: linear-gradient(135deg, #8b7355, #6b5d4f);
        color: #faf8f3;
        align-self: flex-end;
        border-bottom-right-radius: 2px;
      }

      .bubble.bot {
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(139, 115, 85, 0.3);
        color: #3e2723;
        align-self: flex-start;
        border-bottom-left-radius: 2px;
      }

      .chat-input-row {
        display: flex;
        gap: 6px;
        align-items: center;
      }

      .chat-input {
        flex: 1;
        border-radius: 999px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        background: rgba(255, 255, 255, 0.9);
        padding: 6px 10px;
        font-size: 11px;
        color: #3e2723;
      }

      .chat-input:focus {
        outline: none;
        border-color: #8b7355;
      }

      .chat-btn {
        border-radius: 999px;
        border: none;
        padding: 6px 10px;
        font-size: 11px;
        cursor: pointer;
        background: linear-gradient(to right, #8b7355, #6b5d4f);
        color: #faf8f3;
        font-weight: 600;
      }

      .chat-btn:hover {
        opacity: 0.9;
      }

      .chat-quick {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .chat-quick button {
        border-radius: 999px;
        border: 1px solid rgba(139, 115, 85, 0.3);
        background: rgba(255, 255, 255, 0.7);
        padding: 4px 8px;
        font-size: 10px;
        color: #5d4037;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .chat-quick button:hover {
        background: rgba(139, 115, 85, 0.1);
        border-color: #8b7355;
      }

      /* ====== Footer ====== */
      .footer {
        margin-top: 20px;
        padding-top: 16px;
        border-top: 1px solid rgba(139, 115, 85, 0.2);
        font-size: 12px;
        color: #8b7355;
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 8px;
      }

      .footer-contact {
        width: 100%;
        text-align: center;
        margin-top: 12px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 12px;
        border: 1px solid rgba(139, 115, 85, 0.2);
        font-size: 13px;
        color: #5d4037;
        font-weight: 500;
      }

      .email-link {
        color: #689f38;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.2s ease;
      }

      .email-link:hover {
        color: #558b2f;
        text-decoration: underline;
      }

      .highlight {
        color: #689f38;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="brand">
          <div class="brand-logo">AI</div>
          <div>
            <div class="brand-title">AI Smart Backoffice Demo</div>
            <div class="brand-subtitle">
              ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Google Sheets + AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/SME
            </div>
          </div>
        </div>
        <div>
          <div class="pill">
            <span class="pill-dot"></span>
            <span>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡πÄ‡∏ï‡πá‡∏°</span>
          </div>
        </div>
      </header>

      <!-- Controls -->
      <section class="controls">
        <div>
          <div style="font-size: 11px; color: #8b7355; margin-bottom: 4px">
            ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤
          </div>
          <div class="segment">
            <button class="active" data-shop-type="pet">Pet Shop</button>
            <button data-shop-type="food">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>
            <button data-shop-type="salon">‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏ß‡∏¢</button>
          </div>
        </div>
        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
          <button class="btn-template-badge" id="btn-demo-template">Demo Template ‡πÅ‡∏à‡∏Å‡∏ü‡∏£‡∏µ</button>
          <button class="btn-template-badge" id="btn-packages" style="background: linear-gradient(135deg, #689f38, #558b2f);">üì¶ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</button>
        </div>
      </section>

      <!-- Grid -->
      <section class="grid">
        <!-- Left: Dashboard -->
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
              <div class="card-subtitle">
                ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Mock Data) - ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Google Sheets ‡∏à‡∏£‡∏¥‡∏á
              </div>
            </div>
            <div class="badge">Dashboard</div>
          </div>

          <!-- Metrics -->
          <div class="metrics-row">
            <div class="metric" id="metric-sales">
              <div class="metric-label">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£)</div>
              <div class="metric-value"></div>
              <div class="metric-trend"></div>
            </div>
            <div class="metric" id="metric-orders">
              <div class="metric-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
              <div class="metric-value"></div>
              <div class="metric-trend"></div>
            </div>
            <div class="metric" id="metric-profit">
              <div class="metric-label">‡∏Å‡∏≥‡πÑ‡∏£‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</div>
              <div class="metric-value"></div>
              <div class="metric-trend"></div>
            </div>
          </div>

          <!-- Sales Chart -->
          <div class="card-header" style="margin-top: 12px">
            <div class="card-title">‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
            <div class="card-subtitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Google Sheets</div>
          </div>
          <div class="chart-container">
            <canvas id="salesChart"></canvas>
          </div>

          <!-- Orders Table -->
          <div class="card-header" style="margin-top: 8px">
            <div class="card-title">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
            <div class="card-subtitle">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheets</div>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                  <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                  <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                  <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
              </thead>
              <tbody id="orders-body"></tbody>
            </table>
          </div>

          <!-- Alerts -->
          <div class="card-header" style="margin-top: 10px">
            <div class="card-title">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
            <div class="card-subtitle">
              ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å / ‡∏Ñ‡∏¥‡∏ß‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô / ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö
            </div>
          </div>

          <ul class="list" id="alerts-list"></ul>
        </div>

        <!-- Right: AI Chat & Info -->
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">AI Chat Demo</div>
              <div class="card-subtitle">
                ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ù‡∏±‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö)
              </div>
            </div>
            <div class="badge">AI Assistant</div>
          </div>

          <div class="chat-window">
            <div class="chat-messages" id="chat-messages">
              <div class="bubble bot">
                ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ üëã ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡πÄ‡∏î‡πÇ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤
                ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞
              </div>
            </div>
            <div class="chat-quick">
              <button data-q="‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?</button>
              <button data-q="‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏ö‡πâ‡∏≤‡∏á?">‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏ö‡πâ‡∏≤‡∏á?</button>
              <button data-q="‡∏Ñ‡∏¥‡∏ß‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ?">‡∏Ñ‡∏¥‡∏ß‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ?</button>
            </div>
            <div class="chat-input-row">
              <input
                id="chat-input"
                class="chat-input"
                placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÄ‡∏ä‡πà‡∏ô ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ / ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î / ‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß..."
              />
              <button class="chat-btn" id="chat-send">‡∏™‡πà‡∏á</button>
            </div>
          </div>

          <div style="margin-top: 10px; font-size: 11px; color: #9ca3af">
            üîç <span class="highlight">‡πÄ‡∏î‡πÇ‡∏°‡πà‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á</span> ‚Äì
            ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:
            <ul style="margin-top: 4px; padding-left: 16px; list-style: disc">
              <li>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets / BigQuery / ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</li>
              <li>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‚Äì‡∏Å‡∏≥‡πÑ‡∏£‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
              <li>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE / Email ‡πÑ‡∏î‡πâ</li>
              <li>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="footer">
        <div>
          ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï: <span class="highlight">AI Setup ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤/SME</span>
        </div>
        <div>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ï‡πá‡∏°: ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Google Sheets + AI + LINE OA ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£</div>
      </footer>
    </div>

    <!-- Lead Collection Modal -->
    <div class="modal-overlay" id="lead-modal">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö Free Template</div>
          <button class="modal-close" id="modal-close">&times;</button>
        </div>
        <form id="lead-form">
          <div class="form-group">
            <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à *</label>
            <input type="text" class="form-input" name="businessName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥ ABC" />
          </div>
          <div class="form-group">
            <label class="form-label" for="businessType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à *</label>
            <select class="form-select" name="businessType" id="businessType" required title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à">
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
              <option value="pet">Pet Shop</option>
              <option value="food">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</option>
              <option value="salon">‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏ß‡∏¢</option>
              <option value="retail">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å</option>
              <option value="service">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</option>
              <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ *</label>
            <input type="text" class="form-input" name="contactName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" />
          </div>
          <div class="form-group">
            <label class="form-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
            <input type="email" class="form-input" name="email" required placeholder="example@email.com" />
          </div>
          <div class="form-group">
            <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
            <input type="tel" class="form-input" name="phone" required placeholder="08X-XXX-XXXX" />
          </div>
          <div class="form-group">
            <label class="form-label">LINE ID (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
            <input type="text" class="form-input" name="lineId" placeholder="@lineid ‡∏´‡∏£‡∏∑‡∏≠ 08X-XXX-XXXX" />
          </div>
          <button type="submit" class="btn-submit" id="submit-btn">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </form>
        <div class="template-preview" id="template-preview">
          <div style="margin-bottom: 12px; font-weight: 600; color: #5d4037; font-size: 14px;">
            üìä Google Sheets Template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì
          </div>
          <div class="template-tabs" id="template-tabs">
            <div class="template-tab active" data-tab="orders">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
            <div class="template-tab" data-tab="products">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</div>
            <div class="template-tab" data-tab="customers">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</div>
            <div class="template-tab" data-tab="analytics">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</div>
            <div class="template-tab" data-tab="inventory">‡∏™‡∏ï‡πá‡∏≠‡∏Å</div>
            <div class="template-tab" data-tab="appointments">‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</div>
          </div>
          <div id="template-content">
            <!-- Template content will be inserted here -->
          </div>
          <div class="template-note">
            üí° <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets Template ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Template ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
            ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡πÄ‡∏ï‡πá‡∏°
          </div>
        </div>
      </div>
    </div>

    <!-- Package Selection Modal -->
    <div class="modal-overlay" id="package-modal">
      <div class="modal" style="max-width: 900px;">
        <div class="modal-header">
          <div class="modal-title">üì¶ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</div>
          <button class="modal-close" id="package-modal-close">&times;</button>
        </div>
        <div id="package-selection">
          <div style="margin-bottom: 24px; color: #5d4037; font-size: 14px; line-height: 1.6;">
            <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
          </div>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 24px;">
            <!-- BASIC Package -->
            <div class="package-card" data-package="basic" data-price="3000">
              <div class="package-badge" style="background: linear-gradient(135deg, #8b7355, #6b5d4f);">ü•â BASIC</div>
              <div class="package-price">3,000 ‡∏ø</div>
              <div class="package-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 1 ‡∏£‡∏∞‡∏ö‡∏ö</div>
              <ul class="package-features">
                <li>Google Sheet Template</li>
                <li>‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</li>
                <li>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ AI ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÜ</li>
                <li>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
                <li>‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô 2 ‡∏ß‡∏±‡∏ô</li>
              </ul>
              <div class="package-suitable">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡πá‡∏Å / ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö</div>
              <button class="btn-package-select" data-package="basic">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ô‡∏µ‡πâ</button>
            </div>

            <!-- STANDARD Package -->
            <div class="package-card" data-package="standard" data-price="6500" style="border: 2px solid #689f38;">
              <div class="package-badge" style="background: linear-gradient(135deg, #689f38, #558b2f);">ü•à STANDARD</div>
              <div class="package-price">6,500 ‡∏ø</div>
              <div class="package-title">‡∏£‡∏∞‡∏ö‡∏ö 2‚Äì3 ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô</div>
              <ul class="package-features">
                <li>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ + ‡∏™‡∏ï‡πá‡∏≠‡∏Å + ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£</li>
                <li>AI ‡∏ï‡∏≠‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏•‡∏≤‡∏á)</li>
                <li>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å / ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</li>
                <li>Dashboard ‡∏™‡∏£‡∏∏‡∏õ</li>
                <li>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
                <li>‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô 3‚Äì5 ‡∏ß‡∏±‡∏ô</li>
              </ul>
              <div class="package-suitable">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô</div>
              <button class="btn-package-select" data-package="standard">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ô‡∏µ‡πâ</button>
            </div>

            <!-- PREMIUM Package -->
            <div class="package-card" data-package="premium" data-price="15000" style="border: 2px solid #f57c00;">
              <div class="package-badge" style="background: linear-gradient(135deg, #f57c00, #e65100);">ü•á PREMIUM</div>
              <div class="package-price">15,000 ‡∏ø</div>
              <div class="package-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ SME</div>
              <ul class="package-features">
                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∏‡∏î</li>
                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡∏î‡πâ‡∏ß‡∏¢ AI</li>
                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</li>
                <li>Dashboard ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</li>
                <li>Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ä‡∏∏‡∏î</li>
                <li>‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏™‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                <li>Support 30 ‡∏ß‡∏±‡∏ô</li>
              </ul>
              <div class="package-suitable">‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ / ‡∏£‡πâ‡∏≤‡∏ô‡∏´‡∏°‡∏≤ / ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å</div>
              <button class="btn-package-select" data-package="premium">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏ô‡∏µ‡πâ</button>
            </div>
          </div>
        </div>

        <!-- Payment QR Code Section -->
        <div id="payment-section" style="display: none;">
          <!-- Step 1: QR Code Payment -->
          <div id="payment-qr-step">
            <div style="text-align: center; margin-bottom: 24px;">
              <h3 style="color: #5d4037; margin-bottom: 12px;">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô QR Code</h3>
              <div style="background: white; padding: 20px; border-radius: 12px; display: inline-block; margin-bottom: 16px; min-width: 250px;">
                <div id="qrcode" style="margin-bottom: 12px; min-height: 200px; display: flex; align-items: center; justify-content: center;"></div>
                <div style="font-size: 18px; font-weight: bold; color: #5d4037; margin-bottom: 8px;" id="package-amount"></div>
                <div style="font-size: 12px; color: #8b7355;" id="package-name"></div>
              </div>
              <div style="color: #5d4037; font-size: 14px; margin-bottom: 16px;">
                <p><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1:</strong> ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                <p style="font-size: 12px; color: #8b7355; margin-top: 8px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</p>
              </div>
              <div style="margin-top: 20px;">
                <button class="btn-submit" id="verify-payment-btn" style="max-width: 300px; margin: 0 auto;">
                  ‚úì ‡∏â‡∏±‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô)
                </button>
              </div>
              <div id="payment-error" style="display: none; margin-top: 16px; padding: 12px; background: #ffebee; border-radius: 8px; color: #c62828;">
                <p style="margin-bottom: 8px;"><strong>‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ</strong></p>
                <p style="font-size: 12px; margin-bottom: 12px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:</p>
                <ul style="text-align: left; font-size: 12px; margin-left: 20px; margin-bottom: 12px;">
                  <li>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</li>
                  <li>‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</li>
                  <li>‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
                </ul>
                <button class="btn-submit" id="contact-support-btn" style="background: linear-gradient(135deg, #f57c00, #e65100); max-width: 250px;">
                  üìß ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
                </button>
              </div>
            </div>
          </div>

          <!-- Step 2: Requirements Form (shown after payment verification) -->
          <div id="payment-form-step" style="display: none;">
            <div style="text-align: center; margin-bottom: 24px;">
              <h3 style="color: #5d4037; margin-bottom: 12px;">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</h3>
              <p style="color: #8b7355; font-size: 14px; margin-bottom: 20px;">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ</p>
            </div>
            <form id="package-form" style="max-width: 500px; margin: 0 auto;">
              <div class="form-group">
                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à *</label>
                <input type="text" class="form-input" name="businessName" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥ ABC" />
              </div>
              <div class="form-group">
                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ *</label>
                <input type="text" class="form-input" name="contactName" required placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" />
              </div>
              <div class="form-group">
                <label class="form-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                <input type="email" class="form-input" name="email" required placeholder="example@email.com" />
              </div>
              <div class="form-group">
                <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                <input type="tel" class="form-input" name="phone" required placeholder="08X-XXX-XXXX" />
              </div>
              <div class="form-group">
                <label class="form-label">LINE ID (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                <input type="text" class="form-input" name="lineId" placeholder="@lineid ‡∏´‡∏£‡∏∑‡∏≠ 08X-XXX-XXXX" />
              </div>
              <div class="form-group">
                <label class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ / ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ *</label>
                <textarea class="form-input" name="requirements" rows="4" required placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å, ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô, ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏Ø‡∏•‡∏Ø"></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                <textarea class="form-input" name="additionalInfo" rows="3" placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á"></textarea>
              </div>
              <button type="submit" class="btn-submit" id="package-submit-btn">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Load QRCode library with proper error handling
      (function() {
        let qrCodeLoaded = false;
        let attempts = 0;
        const maxAttempts = 3;
        const cdnUrls = [
          'https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs@gh-pages/qrcode.min.js',
          'https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js',
          'https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js',
          'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js',
          'https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js'
        ];
        
        function checkQRCodeLibrary() {
          // Check for qrcodejs (davidshimjs) - uses QRCode constructor
          if (typeof QRCode !== 'undefined' && typeof QRCode === 'function') {
            qrCodeLoaded = true;
            DEBUG.log('‚úì QRCode library (qrcodejs) loaded successfully');
            return true;
          }
          // Check for qrcode npm package - uses QRCode.toCanvas
          const qrCode = window.QRCode || window.qrcode;
          if (qrCode && typeof qrCode.toCanvas === 'function') {
            if (!window.QRCode) {
              window.QRCode = qrCode;
            }
            qrCodeLoaded = true;
            DEBUG.log('‚úì QRCode library (qrcode npm) loaded successfully');
            return true;
          }
          return false;
        }
        
        function loadQRCodeLibrary(urlIndex) {
          if (urlIndex >= cdnUrls.length) {
            DEBUG.error('‚úó All CDNs failed to load QRCode library');
            // Set a flag so we can use fallback
            window.qrCodeLibraryFailed = true;
            return;
          }
          
          const script = document.createElement('script');
          script.src = cdnUrls[urlIndex];
          script.async = true;
          
          script.onload = function() {
            // Give it multiple moments to initialize (some CDNs need more time)
            let checkAttempts = 0;
            const maxCheckAttempts = 20; // 2 seconds total
            
            const checkInterval = setInterval(function() {
              checkAttempts++;
              if (checkQRCodeLibrary()) {
                clearInterval(checkInterval);
                // Library loaded successfully
                return;
              } else if (checkAttempts >= maxCheckAttempts) {
                clearInterval(checkInterval);
                // Try next CDN
                DEBUG.warn('QRCode library loaded but not available after checks, trying next CDN...');
                loadQRCodeLibrary(urlIndex + 1);
              }
            }, 100);
          };
          
          script.onerror = function(e) {
            DEBUG.warn('CDN failed:', cdnUrls[urlIndex], e);
            // Remove failed script
            script.remove();
            loadQRCodeLibrary(urlIndex + 1);
          };
          
          // Add timeout for script loading (10 seconds per CDN)
          const timeout = setTimeout(function() {
            if (!qrCodeLoaded) {
              DEBUG.warn('CDN timeout:', cdnUrls[urlIndex]);
              script.remove();
              script.onerror = null; // Prevent double error
              loadQRCodeLibrary(urlIndex + 1);
            }
          }, 10000);
          
          // Clear timeout if script loads successfully
          const originalOnload = script.onload;
          script.onload = function() {
            clearTimeout(timeout);
            if (originalOnload) originalOnload.call(this);
          };
          
          document.head.appendChild(script);
        }
        
        // Start loading
        loadQRCodeLibrary(0);
        
        // Expose check function globally
        window.checkQRCodeReady = function() {
          return checkQRCodeLibrary();
        };
      })();
      // ===== Mock Data per shop type =====
      const DATA = {
        pet: {
          metrics: {
            sales: { value: "12,450 ‡∏ø", trend: "+18% vs ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô" },
            orders: { value: "24 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", trend: "5 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà" },
            profit: { value: "4,980 ‡∏ø", trend: "+12% ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥" },
          },
          chartData: {
            labels: ["6 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "4 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "2 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô", "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ"],
            sales: [8500, 9200, 10800, 11200, 10500, 11800, 12450],
          },
          orders: [
            {
              time: "10:15",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö",
              detail: "‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥+‡∏ï‡∏±‡∏î‡∏Ç‡∏ô + ‡∏Ç‡∏ô‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç",
              total: "890 ‡∏ø",
              status: "‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß",
            },
            {
              time: "11:40",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏õ‡πâ‡∏á",
              detail: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏°‡πá‡∏î 3 ‡∏Å‡∏Å. + ‡∏ó‡∏£‡∏µ‡∏ï",
              total: "1,250 ‡∏ø",
              status: "‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
            },
            {
              time: "13:05",
              customer: "‡∏Ñ‡∏∏‡∏ì‡∏ü‡πâ‡∏≤",
              detail: "‡∏ù‡∏≤‡∏Å‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á 1 ‡∏ß‡∏±‡∏ô (L)",
              total: "750 ‡∏ø",
              status: "‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß",
            },
            {
              time: "14:30",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠",
              detail: "‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç + ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û",
              total: "1,500 ‡∏ø",
              status: "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à",
            },
            {
              time: "15:20",
              customer: "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏¥‡πâ‡∏á",
              detail: "‡∏Ç‡∏ô‡∏°‡πÅ‡∏°‡∏ß + ‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô",
              total: "450 ‡∏ø",
              status: "‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß",
            },
            {
              time: "16:10",
              customer: "‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏π‡∏ô",
              detail: "‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡∏∏‡∏ô‡∏±‡∏Ç 2 ‡∏ï‡∏±‡∏ß",
              total: "600 ‡∏ø",
              status: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥",
            },
          ],
          alerts: [
            {
              text: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏°‡πá‡∏î‡∏™‡∏π‡∏ï‡∏£‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡πÄ‡∏•‡πá‡∏Å 1 ‡∏Å‡∏Å. ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 4 ‡∏ñ‡∏∏‡∏á (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)",
              tag: "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î",
            },
            {
              text: "‡∏ô‡πâ‡∏≠‡∏á‡∏•‡∏π‡∏Ñ‡∏±‡∏™ ‚Äì ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ 18:00 ‡∏ô.",
              tag: "‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô",
            },
            {
              text: "‡∏°‡∏µ‡∏ô‡∏±‡∏î‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡∏∏‡∏ô‡∏±‡∏Ç 5 ‡∏Ñ‡∏¥‡∏ß ‡πÄ‡∏ß‡∏•‡∏≤ 15:00‚Äì17:00 ‡∏ô.",
              tag: "‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß",
            },
            {
              text: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å 3 ‡∏Ñ‡∏ô ‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô",
              tag: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô",
            },
          ],
        },
        food: {
          metrics: {
            sales: { value: "18,320 ‡∏ø", trend: "+25% ‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô" },
            orders: { value: "56 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", trend: "32 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡πà" },
            profit: { value: "6,740 ‡∏ø", trend: "+9% ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô" },
          },
          chartData: {
            labels: ["6 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "4 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "2 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô", "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ"],
            sales: [14200, 15600, 16800, 15200, 17500, 16800, 18320],
          },
          orders: [
            {
              time: "11:20",
              customer: "Grab",
              detail: "‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ã‡πà‡∏ö x3",
              total: "540 ‡∏ø",
              status: "‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
            },
            {
              time: "12:05",
              customer: "Lineman",
              detail: "‡∏™‡∏•‡∏±‡∏î‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô + ‡∏ô‡πâ‡∏≥‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£",
              total: "280 ‡∏ø",
              status: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∏‡∏á",
            },
            {
              time: "12:45",
              customer: "‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô",
              detail: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏¢‡∏≥‡∏ó‡∏∞‡πÄ‡∏•‡∏£‡∏ß‡∏° 2 ‡∏ó‡∏µ‡πà",
              total: "380 ‡∏ø",
              status: "‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÅ‡∏•‡πâ‡∏ß",
            },
            {
              time: "13:10",
              customer: "Robinhood",
              detail: "‡∏Å‡∏∏‡πâ‡∏á‡∏î‡∏≠‡∏á‡∏ã‡∏µ‡∏≠‡∏¥‡πä‡∏ß + ‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏ß‡∏¢",
              total: "320 ‡∏ø",
              status: "‡∏£‡∏≠ Rider",
            },
            {
              time: "13:45",
              customer: "Grab",
              detail: "‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á + ‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏ß‡∏¢ x2",
              total: "420 ‡∏ø",
              status: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∏‡∏á",
            },
            {
              time: "14:20",
              customer: "‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô",
              detail: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á + ‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°",
              total: "180 ‡∏ø",
              status: "‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÅ‡∏•‡πâ‡∏ß",
            },
          ],
          alerts: [
            {
              text: "‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î Lot ‡πÄ‡∏ä‡πâ‡∏≤ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 3 ‡∏Å‡∏Å. ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏¢‡πá‡∏ô",
              tag: "‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö",
            },
            {
              text: "‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î Batch 02/05 ‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏£‡∏ö‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",
              tag: "‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û",
            },
            {
              text: "‡∏¢‡∏≠‡∏î‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á +32% ‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡πâ‡∏≤",
              tag: "Performance",
            },
            {
              text: "‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ã‡πà‡∏ö‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ 15 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå",
              tag: "‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°",
            },
          ],
        },
        salon: {
          metrics: {
            sales: { value: "9,780 ‡∏ø", trend: "+10% ‡∏à‡∏≤‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏Å‡πà‡∏≠‡∏ô" },
            orders: { value: "17 ‡∏Ñ‡∏¥‡∏ß", trend: "4 ‡∏Ñ‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà" },
            profit: { value: "4,200 ‡∏ø", trend: "‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å 6 ‡πÄ‡∏Ñ‡∏™" },
          },
          chartData: {
            labels: ["6 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "4 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "2 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß", "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô", "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ"],
            sales: [8200, 8900, 8500, 9200, 8800, 9500, 9780],
          },
          orders: [
            {
              time: "10:00",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏°‡∏¢‡πå",
              detail: "‡∏ó‡∏≥‡∏™‡∏µ + ‡∏ó‡∏£‡∏µ‡∏ï‡πÄ‡∏°‡∏ô‡∏ï‡πå",
              total: "2,300 ‡∏ø",
              status: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£",
            },
            {
              time: "11:30",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏≠‡∏ô",
              detail: "‡∏™‡∏õ‡∏≤‡∏°‡∏∑‡∏≠+‡∏™‡∏õ‡∏≤‡πÄ‡∏ó‡πâ‡∏≤",
              total: "1,200 ‡∏ø",
              status: "‡∏à‡∏ö‡∏Ñ‡∏¥‡∏ß",
            },
            {
              time: "13:00",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏õ‡πâ‡∏á",
              detail: "‡∏ï‡πà‡∏≠‡∏Ç‡∏ô‡∏ï‡∏≤ + ‡∏Ñ‡∏¥‡πâ‡∏ß‡πÇ‡∏´‡∏á‡∏ß‡πÄ‡∏Æ‡πâ‡∏á",
              total: "2,800 ‡∏ø",
              status: "‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß",
            },
            {
              time: "14:30",
              customer: "‡∏Ñ‡∏∏‡∏ì‡∏ü‡∏≤‡∏á",
              detail: "‡∏™‡∏£‡∏∞‡πÑ‡∏î‡∏£‡πå + ‡∏ó‡∏£‡∏µ‡∏ï‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô",
              total: "980 ‡∏ø",
              status: "‡∏£‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡πâ‡∏≤‡∏≠‡∏µ‡πâ",
            },
            {
              time: "15:00",
              customer: "‡∏Ñ‡∏∏‡∏ì‡∏°‡∏¥‡πâ‡∏ô",
              detail: "‡∏ï‡∏±‡∏î‡∏ú‡∏° + ‡∏ó‡∏≥‡∏™‡∏µ",
              total: "1,500 ‡∏ø",
              status: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£",
            },
            {
              time: "16:00",
              customer: "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏≠‡∏°",
              detail: "‡∏ô‡∏ß‡∏î‡∏´‡∏ô‡πâ‡∏≤ + ‡∏ó‡∏£‡∏µ‡∏ï‡πÄ‡∏°‡∏ô‡∏ï‡πå",
              total: "1,000 ‡∏ø",
              status: "‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß",
            },
          ],
          alerts: [
            {
              text: "‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏î‡∏±‡∏î‡∏ú‡∏°‡∏™‡∏π‡∏ï‡∏£ Premium ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3 ‡πÄ‡∏Ñ‡∏™‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢",
              tag: "‡∏™‡∏ï‡πá‡∏≠‡∏Å",
            },
            {
              text: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å 5 ‡∏Ñ‡∏ô ‡∏°‡∏µ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô",
              tag: "‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î",
            },
            {
              text: "‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏¥‡∏ß‡πÅ‡∏ô‡πà‡∏ô‡∏ä‡πà‡∏ß‡∏á 13:00‚Äì16:00 ‡∏ô. ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå",
              tag: "‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏¥‡∏ß",
            },
            {
              text: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà 4 ‡∏Ñ‡∏ô ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ",
              tag: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢",
            },
          ],
        },
      };

      // Chart instance
      let salesChart = null;

      const shopButtons = document.querySelectorAll("[data-shop-type]");
      const metricSales = document.getElementById("metric-sales");
      const metricOrders = document.getElementById("metric-orders");
      const metricProfit = document.getElementById("metric-profit");
      const ordersBody = document.getElementById("orders-body");
      const alertsList = document.getElementById("alerts-list");

      function renderShop(type) {
        const d = DATA[type];

        // Metrics
        metricSales.querySelector(".metric-value").textContent =
          d.metrics.sales.value;
        metricSales.querySelector(".metric-trend").textContent =
          d.metrics.sales.trend;
        metricSales.querySelector(".metric-trend").className =
          "metric-trend trend-up";

        metricOrders.querySelector(".metric-value").textContent =
          d.metrics.orders.value;
        metricOrders.querySelector(".metric-trend").textContent =
          d.metrics.orders.trend;
        metricOrders.querySelector(".metric-trend").className =
          "metric-trend trend-up";

        metricProfit.querySelector(".metric-value").textContent =
          d.metrics.profit.value;
        metricProfit.querySelector(".metric-trend").textContent =
          d.metrics.profit.trend;
        metricProfit.querySelector(".metric-trend").className =
          "metric-trend trend-up";

        // Render Chart
        renderChart(d.chartData);

        // Orders table
        ordersBody.innerHTML = "";
        d.orders.forEach((o) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${o.time}</td>
            <td>${o.customer}</td>
            <td>${o.detail}</td>
            <td>${o.total}</td>
            <td>
              <span class="status-pill ${
                o.status.includes("‡∏£‡∏≠") || o.status.includes("‡∏Å‡∏≥‡∏•‡∏±‡∏á")
                  ? "status-pending"
                  : "status-done"
              }">
                ${o.status}
              </span>
            </td>
          `;
          ordersBody.appendChild(tr);
        });

        // Alerts
        alertsList.innerHTML = "";
        d.alerts.forEach((a) => {
          const li = document.createElement("li");
          li.className = "list-item";
          li.innerHTML = `
            <div class="list-text">${a.text}</div>
            <div class="list-tag">${a.tag}</div>
          `;
          alertsList.appendChild(li);
        });
      }

      function renderChart(chartData) {
        const ctx = document.getElementById("salesChart");
        if (salesChart) {
          salesChart.destroy();
        }
        salesChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: chartData.labels,
            datasets: [
              {
                label: "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)",
                data: chartData.sales,
                borderColor: "#8b7355",
                backgroundColor: "rgba(139, 115, 85, 0.1)",
                borderWidth: 2,
                fill: true,
                tension: 0.4,
                pointBackgroundColor: "#8b7355",
                pointBorderColor: "#faf8f3",
                pointBorderWidth: 2,
                pointRadius: 4,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false,
              },
            },
            scales: {
              y: {
                beginAtZero: true,
                grid: {
                  color: "rgba(139, 115, 85, 0.1)",
                },
                ticks: {
                  color: "#8b7355",
                  callback: function (value) {
                    return value.toLocaleString() + " ‡∏ø";
                  },
                },
              },
              x: {
                grid: {
                  display: false,
                },
                ticks: {
                  color: "#8b7355",
                },
              },
            },
          },
        });
      }

      shopButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          shopButtons.forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          renderShop(btn.dataset.shopType);
        });
      });

      // Initial render
      renderShop("pet");

      // ===== Chat Demo =====
      const chatMessages = document.getElementById("chat-messages");
      const chatInput = document.getElementById("chat-input");
      const chatSend = document.getElementById("chat-send");
      const quickButtons = document.querySelectorAll(".chat-quick button");

      function addBubble(text, type) {
        const div = document.createElement("div");
        div.className = "bubble " + type;
        div.textContent = text;
        chatMessages.appendChild(div);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function botReply(message) {
        const shopType = document.querySelector(
          ".segment button.active"
        ).dataset.shopType;

        let reply =
          "‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡πÇ‡∏°‡πà‡∏Ñ‡πà‡∏∞ ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÅ‡∏•‡∏∞‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ö‡∏ö Real-time üß†";

        const m = message.toLowerCase();
        if (m.includes("‡∏Ç‡∏≤‡∏¢") || m.includes("‡∏¢‡∏≠‡∏î")) {
          if (shopType === "pet") {
            reply = "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ Pet Shop ‡∏ó‡∏≥‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á = 12,450 ‡∏ö‡∏≤‡∏ó ‡∏à‡∏≤‡∏Å 24 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ñ‡πà‡∏∞ üê∂";
          } else if (shopType === "food") {
            reply =
              "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≥‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á = 18,320 ‡∏ö‡∏≤‡∏ó ‡∏à‡∏≤‡∏Å 56 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ñ‡πà‡∏∞ üç§";
          } else {
            reply =
              "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏ß‡∏¢‡∏ó‡∏≥‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á = 9,780 ‡∏ö‡∏≤‡∏ó ‡∏à‡∏≤‡∏Å 17 ‡∏Ñ‡∏¥‡∏ß‡∏Ñ‡πà‡∏∞ ‚úÇÔ∏è";
          }
          reply +=
            "\n\n‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥";
        } else if (m.includes("‡∏™‡∏ï‡πá‡∏≠‡∏Å") || m.includes("‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î")) {
          reply =
            "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å:\n‚Ä¢ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏ß‡πâ\n‚Ä¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ LINE ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ\n\n‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥/‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÉ‡∏ô Google Sheets ‡∏Ñ‡πà‡∏∞ üìä";
        } else if (m.includes("‡∏Ñ‡∏¥‡∏ß") || m.includes("‡∏à‡∏≠‡∏á")) {
          reply =
            "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏ß:\n‚Ä¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤\n‚Ä¢ ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏¥‡∏ß\n‚Ä¢ ‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n\n‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏ß‡∏¢ / ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å / Pet Shop ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏Ñ‡πà‡∏∞ üìÖ";
        }

        setTimeout(() => addBubble(reply, "bot"), 500);
      }

      function handleSend() {
        const text = chatInput.value.trim();
        if (!text) return;
        addBubble(text, "user");
        chatInput.value = "";
        botReply(text);
      }

      chatSend.addEventListener("click", handleSend);
      chatInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") handleSend();
      });

      quickButtons.forEach((btn) =>
        btn.addEventListener("click", () => {
          const q = btn.dataset.q;
          addBubble(q, "user");
          botReply(q);
        })
      );

      // ===== Additional Functions =====
      
      // Export data function
      function exportData() {
        const shopType = document.querySelector(
          ".segment button.active"
        ).dataset.shopType;
        const data = DATA[shopType];
        const csv = [
          ["‡πÄ‡∏ß‡∏•‡∏≤", "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î", "‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"],
          ...data.orders.map((o) => [
            o.time,
            o.customer,
            o.detail,
            o.total,
            o.status,
          ]),
        ]
          .map((row) => row.join(","))
          .join("\n");
        
        const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `orders_${shopType}_${new Date().toISOString().split("T")[0]}.csv`;
        link.click();
      }

      // Refresh data function (simulated)
      function refreshData() {
        const shopType = document.querySelector(
          ".segment button.active"
        ).dataset.shopType;
        renderShop(shopType);
        addBubble("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞", "bot");
      }

      // Add keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        if (e.ctrlKey || e.metaKey) {
          if (e.key === "r") {
            e.preventDefault();
            refreshData();
          } else if (e.key === "e") {
            e.preventDefault();
            exportData();
          }
        }
      });

      // ===== Lead Collection Modal =====
      const leadModal = document.getElementById("lead-modal");
      const btnDemoTemplate = document.getElementById("btn-demo-template");
      const modalClose = document.getElementById("modal-close");
      const leadForm = document.getElementById("lead-form");
      const templatePreview = document.getElementById("template-preview");
      const templateContent = document.getElementById("template-content");
      const templateTabs = document.querySelectorAll(".template-tab");

      // Open modal
      btnDemoTemplate.addEventListener("click", () => {
        leadModal.classList.add("active");
        templatePreview.classList.remove("active");
        leadForm.reset();
      });

      // Close modal
      function closeModal() {
        leadModal.classList.remove("active");
        templatePreview.classList.remove("active");
        leadForm.style.display = "block";
        leadForm.reset();
      }

      modalClose.addEventListener("click", closeModal);

      leadModal.addEventListener("click", (e) => {
        if (e.target === leadModal) {
          closeModal();
        }
      });

      // Template data - Comprehensive structure for demo app
      const templateData = {
        orders: {
          headers: ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", "‡πÄ‡∏ß‡∏•‡∏≤", "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", "‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô", "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢", "‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°", "‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î", "‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"],
          rows: [
            ["2024-01-15", "10:15", "ORD-001", "C001", "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö", "‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥+‡∏ï‡∏±‡∏î‡∏Ç‡∏ô", "1", "890", "890", "0", "890", "‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß", "‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô", ""],
            ["2024-01-15", "11:40", "ORD-002", "C002", "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏õ‡πâ‡∏á", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏°‡πá‡∏î 3 ‡∏Å‡∏Å.", "1", "1250", "1250", "50", "1200", "‡∏à‡∏±‡∏î‡∏™‡πà‡∏á", "‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå", "‡∏™‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô"],
            ["2024-01-15", "13:05", "ORD-003", "C003", "‡∏Ñ‡∏∏‡∏ì‡∏ü‡πâ‡∏≤", "‡∏ù‡∏≤‡∏Å‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á 1 ‡∏ß‡∏±‡∏ô", "1", "750", "750", "0", "750", "‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß", "‡πÇ‡∏ó‡∏£‡∏à‡∏≠‡∏á", ""],
            ["2024-01-15", "14:30", "ORD-004", "C001", "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö", "‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°", "1", "1500", "1500", "100", "1400", "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à", "‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô", "‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢"],
          ]
        },
        products: {
          headers: ["‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó", "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà", "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢", "‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô", "‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢", "‡∏Å‡∏≥‡πÑ‡∏£%", "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥", "‡∏´‡∏ô‡πà‡∏ß‡∏¢", "‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°"],
          rows: [
            ["P001", "‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡∏∏‡∏ô‡∏±‡∏Ç", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•", "300", "100", "200", "66.7%", "-", "-", "‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "-", "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "2024-01-01"],
            ["P002", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏°‡πá‡∏î‡∏™‡∏∏‡∏ô‡∏±‡∏Ç 1 ‡∏Å‡∏Å.", "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå", "450", "280", "170", "37.8%", "15", "5", "‡∏ñ‡∏∏‡∏á", "ABC Pet Supply", "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "2024-01-01"],
            ["P003", "‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏£‡∏ß‡∏°", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û", "1500", "800", "700", "46.7%", "-", "-", "‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "-", "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "2024-01-01"],
            ["P004", "‡∏ù‡∏≤‡∏Å‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á 1 ‡∏ß‡∏±‡∏ô", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•", "750", "200", "550", "73.3%", "-", "-", "‡∏ß‡∏±‡∏ô", "-", "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "2024-01-01"],
            ["P005", "‡∏Ç‡∏ô‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç", "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå", "120", "60", "60", "50.0%", "25", "10", "‡∏ñ‡∏∏‡∏á", "XYZ Pet Food", "‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "2024-01-05"],
          ]
        },
        customers: {
          headers: ["‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•", "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£", "‡∏≠‡∏µ‡πÄ‡∏°‡∏•", "LINE ID", "‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà", "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£", "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°", "‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏°", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", "‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏"],
          rows: [
            ["C001", "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö", "081-234-5678", "bo@email.com", "@bo123", "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø", "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", "2024-01-01", "250", "3240", "5", "2024-01-15", "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥"],
            ["C002", "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏õ‡πâ‡∏á", "082-345-6789", "paeng@email.com", "-", "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", "2024-01-10", "0", "1200", "1", "2024-01-15", "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", ""],
            ["C003", "‡∏Ñ‡∏∏‡∏ì‡∏ü‡πâ‡∏≤", "083-456-7890", "fah@email.com", "@fah456", "‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ", "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", "2023-12-15", "500", "4500", "8", "2024-01-15", "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", "VIP"],
            ["C004", "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠", "084-567-8901", "o@email.com", "@o789", "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø", "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", "2024-01-12", "100", "1500", "2", "2024-01-14", "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", ""],
          ]
        },
        analytics: {
          headers: ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°", "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå", "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà", "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤", "‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô", "‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå", "‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°", "‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢", "‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥", "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡πÑ‡∏£%", "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå"],
          rows: [
            ["2024-01-15", "12450", "24", "5", "19", "15", "9", "4980", "1200", "3780", "30.3%", "518.75"],
            ["2024-01-14", "10500", "20", "3", "17", "12", "8", "4200", "1100", "3100", "29.5%", "525.00"],
            ["2024-01-13", "11800", "22", "4", "18", "14", "8", "4720", "1150", "3570", "30.3%", "536.36"],
            ["2024-01-12", "11200", "21", "2", "19", "13", "8", "4480", "1080", "3400", "30.4%", "533.33"],
            ["2024-01-11", "9800", "18", "1", "17", "11", "7", "3920", "1000", "2920", "29.8%", "544.44"],
          ]
        },
        inventory: {
          headers: ["‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥", "‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î", "‡∏´‡∏ô‡πà‡∏ß‡∏¢", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", "‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏ï‡πá‡∏≠‡∏Å", "‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ 30 ‡∏ß‡∏±‡∏ô", "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"],
          rows: [
            ["P002", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏°‡πá‡∏î‡∏™‡∏∏‡∏ô‡∏±‡∏Ç 1 ‡∏Å‡∏Å.", "15", "5", "50", "‡∏ñ‡∏∏‡∏á", "‡∏õ‡∏Å‡∏ï‡∏¥", "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°", "4200", "45", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå"],
            ["P005", "‡∏Ç‡∏ô‡∏°‡∏™‡∏∏‡∏ô‡∏±‡∏Ç", "25", "10", "100", "‡∏ñ‡∏∏‡∏á", "‡∏õ‡∏Å‡∏ï‡∏¥", "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°", "3000", "60", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πå"],
            ["P006", "‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏∏‡∏ô‡∏±‡∏Ç", "8", "10", "30", "‡∏ä‡∏¥‡πâ‡∏ô", "‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î", "‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°", "2400", "12", "‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô"],
            ["P007", "‡∏™‡∏≤‡∏¢‡∏à‡∏π‡∏á", "5", "5", "20", "‡πÄ‡∏™‡πâ‡∏ô", "‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î", "‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°", "1500", "8", "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå"],
          ]
        },
        appointments: {
          headers: ["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", "‡πÄ‡∏ß‡∏•‡∏≤", "‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£", "‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞", "‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏", "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô", "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å"],
          rows: [
            ["2024-01-16", "10:00", "C001", "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ö", "081-234-5678", "‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥+‡∏ï‡∏±‡∏î‡∏Ç‡∏ô", "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß", "‡∏û‡∏µ‡πà‡πÅ‡∏≠‡∏ô", "", "‚úì", ""],
            ["2024-01-16", "11:30", "C003", "‡∏Ñ‡∏∏‡∏ì‡∏ü‡πâ‡∏≤", "083-456-7890", "‡∏ù‡∏≤‡∏Å‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á", "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß", "‡∏û‡∏µ‡πà‡∏°‡∏¥‡πâ‡∏á", "2 ‡∏ß‡∏±‡∏ô", "‚úì", ""],
            ["2024-01-16", "14:00", "C004", "‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏≠", "084-567-8901", "‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô", "‡∏£‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô", "-", "‡∏ô‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà", "", ""],
            ["2024-01-17", "09:00", "C002", "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏õ‡πâ‡∏á", "082-345-6789", "‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥", "‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß", "‡∏û‡∏µ‡πà‡πÅ‡∏≠‡∏ô", "", "‚úì", ""],
          ]
        }
      };

      // Render template table
      function renderTemplate(tabName) {
        const data = templateData[tabName];
        if (!data) return;

        let html = `<table class="template-table"><thead><tr>`;
        data.headers.forEach(header => {
          html += `<th>${header}</th>`;
        });
        html += `</tr></thead><tbody>`;
        
        data.rows.forEach(row => {
          html += `<tr>`;
          row.forEach(cell => {
            html += `<td>${cell}</td>`;
          });
          html += `</tr>`;
        });
        
        html += `</tbody></table>`;
        templateContent.innerHTML = html;
      }

      // Tab switching
      templateTabs.forEach(tab => {
        tab.addEventListener("click", () => {
          templateTabs.forEach(t => t.classList.remove("active"));
          tab.classList.add("active");
          renderTemplate(tab.dataset.tab);
        });
      });

      // Google Apps Script Web App URL
      // Supports dynamic API endpoint via URL parameter for multi-tenant scaling
      // Usage: myapp.com?api=https://script.google.com/.../exec
      // Falls back to demo URL if no parameter provided
      const urlParams = new URLSearchParams(window.location.search);
      const apiParam = urlParams.get('api');
      const DEMO_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyY7zhH35IxE38Jr0Ksm0pcsBqEcdVOCyMzzokVFL4bTaAA2emwWxDbU7aJB1O0IkWv1w/exec';
      const GOOGLE_SCRIPT_URL = apiParam || DEMO_SCRIPT_URL;
      
      // Debug utility - can be disabled in production
      const DEBUG = {
        enabled: true, // Set to false in production
        log: function(...args) {
          if (this.enabled) {
            console.log('[DEBUG]', ...args);
          }
        },
        error: function(...args) {
          if (this.enabled) {
            console.error('[ERROR]', ...args);
          }
        },
        warn: function(...args) {
          if (this.enabled) {
            console.warn('[WARN]', ...args);
          }
        }
      };
      
      // Log which URL is being used (for debugging)
      if (apiParam) {
        DEBUG.log('Using customer-specific API endpoint:', apiParam);
      } else {
        DEBUG.log('Using demo API endpoint:', DEMO_SCRIPT_URL);
      }

      // ===== Payment Configuration =====
      // IMPORTANT: Update these settings with your actual payment account details
      const PAYMENT_CONFIG = {
        // Your PromptPay ID (phone number or National ID)
        // Format: 10 digits (phone: 08XXXXXXXX) or 13 digits (National ID)
        // Example: "0812345678" or "1234567890123"
        promptPayId: "0644162478", // ‚ö†Ô∏è REPLACE WITH YOUR ACTUAL PROMPTPAY ID
        
        // Your merchant/business name (will appear in payment details)
        merchantName: "Ped Pro - ‡πÄ‡∏õ‡πá‡∏î‡∏°‡∏∑‡∏≠‡πÇ‡∏õ‡∏£",
        
        // Your contact phone (displayed if QR code fails)
        contactPhone: "0644162478" // ‚ö†Ô∏è REPLACE WITH YOUR CONTACT PHONE
      };
      
      // ===== Package Selection Modal =====
      const packageModal = document.getElementById("package-modal");
      const btnPackages = document.getElementById("btn-packages");
      const packageModalClose = document.getElementById("package-modal-close");
      const packageSelection = document.getElementById("package-selection");
      const paymentSection = document.getElementById("payment-section");
      const packageForm = document.getElementById("package-form");
      let selectedPackage = null;

      // Package info mapping
      const packageInfo = {
        basic: {
          name: "BASIC",
          price: 3000,
          displayName: "ü•â BASIC - ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô 1 ‡∏£‡∏∞‡∏ö‡∏ö"
        },
        standard: {
          name: "STANDARD",
          price: 6500,
          displayName: "ü•à STANDARD - ‡∏£‡∏∞‡∏ö‡∏ö 2‚Äì3 ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô"
        },
        premium: {
          name: "PREMIUM",
          price: 15000,
          displayName: "ü•á PREMIUM - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ SME"
        }
      };

      // Open package modal
      btnPackages.addEventListener("click", () => {
        packageModal.classList.add("active");
        packageSelection.style.display = "block";
        paymentSection.style.display = "none";
        selectedPackage = null;
      });

      // Close package modal
      function closePackageModal() {
        packageModal.classList.remove("active");
        packageSelection.style.display = "block";
        paymentSection.style.display = "none";
        document.getElementById("payment-qr-step").style.display = "block";
        document.getElementById("payment-form-step").style.display = "none";
        document.getElementById("payment-error").style.display = "none";
        packageForm.reset();
        selectedPackage = null;
        paymentVerified = false;
        verifiedAmount = null;
        document.getElementById("qrcode").innerHTML = "";
      }

      packageModalClose.addEventListener("click", closePackageModal);
      packageModal.addEventListener("click", (e) => {
        if (e.target === packageModal) {
          closePackageModal();
        }
      });

      // Handle package selection
      document.querySelectorAll(".btn-package-select").forEach(btn => {
        btn.addEventListener("click", () => {
          const packageType = btn.dataset.package;
          selectedPackage = packageType;
          const info = packageInfo[packageType];
          
          // Hide selection, show payment QR step
          packageSelection.style.display = "none";
          paymentSection.style.display = "block";
          document.getElementById("payment-qr-step").style.display = "block";
          document.getElementById("payment-form-step").style.display = "none";
          document.getElementById("payment-error").style.display = "none";
          
          // Update package info
          document.getElementById("package-amount").textContent = `${info.price.toLocaleString()} ‡∏ø`;
          document.getElementById("package-name").textContent = info.displayName;
          
          // Generate Thai QR Code for payment (with delay to ensure library is loaded)
          setTimeout(() => {
            generateThaiQRCode(info.price, info.name);
          }, 100);
        });
      });

      // Payment verification
      let paymentVerified = false;
      let verifiedAmount = null;
      
      function verifyPayment() {
        if (!selectedPackage) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏Å‡πà‡∏≠‡∏ô");
          return;
        }
        
        const info = packageInfo[selectedPackage];
        const expectedAmount = info.price;
        
        // Show confirmation dialog
        const confirmed = confirm(
          `‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô\n\n` +
          `‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à: ${info.displayName}\n` +
          `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: ${expectedAmount.toLocaleString()} ‡∏ø\n\n` +
          `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`
        );
        
        if (!confirmed) {
          return; // User cancelled
        }
        
        // Payment verified - proceed to form
        paymentVerified = true;
        verifiedAmount = expectedAmount;
        
        // Hide QR step, show form step
        document.getElementById("payment-qr-step").style.display = "none";
        document.getElementById("payment-form-step").style.display = "block";
        document.getElementById("payment-error").style.display = "none";
        
        DEBUG.log('Payment verified:', {
          package: selectedPackage,
          amount: verifiedAmount,
          status: 'Verified'
        });
      }
      
      // Attach event listener to verify button
      const verifyBtn = document.getElementById("verify-payment-btn");
      if (verifyBtn) {
        verifyBtn.addEventListener("click", verifyPayment);
      }
      
      // Handle payment error contact support
      document.addEventListener("click", (e) => {
        if (e.target && e.target.id === "contact-support-btn") {
          const info = packageInfo[selectedPackage];
          const subject = encodeURIComponent(`‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô - ‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à ${info.displayName}`);
          const body = encodeURIComponent(
            `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞\n\n` +
            `‡∏â‡∏±‡∏ô‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à: ${info.displayName}\n` +
            `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞: ${info.price.toLocaleString()} ‡∏ø\n\n` +
            `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞\n\n` +
            `‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞`
          );
          const email = 'tripetkk@gmail.com';
          window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
        }
        
        if (e.target && e.target.id === "retry-payment-btn") {
          document.getElementById("payment-error").style.display = "none";
        }
      });

      // Fallback payment display when QR code library fails
      function showPaymentFallback(container, amount, packageName) {
        const promptPayId = PAYMENT_CONFIG.promptPayId;
        const merchantName = PAYMENT_CONFIG.merchantName;
        
        container.innerHTML = 
          '<div style="padding: 20px; text-align: center; border: 2px solid #8b7355; border-radius: 8px; background: #f5f1e8;">' +
          '<div style="font-size: 18px; font-weight: bold; color: #8b7355; margin-bottom: 15px;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>' +
          '<div style="font-size: 24px; font-weight: bold; color: #689f38; margin-bottom: 10px;">' + amount.toLocaleString() + ' ‡∏ø</div>' +
          '<div style="margin: 15px 0; padding: 15px; background: white; border-radius: 6px;">' +
          '<div style="color: #5d4037; margin-bottom: 8px;"><strong>PromptPay ID:</strong></div>' +
          '<div style="font-size: 20px; font-weight: bold; color: #8b7355; letter-spacing: 2px; margin-bottom: 15px;">' + promptPayId + '</div>' +
          '<div style="color: #5d4037; font-size: 14px; margin-top: 10px;">' +
          '‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô: ' + merchantName + '<br>' +
          '‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à: ' + packageName +
          '</div>' +
          '</div>' +
          '<div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-radius: 6px; color: #856404; font-size: 13px;">' +
          'üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:<br>' +
          '1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì<br>' +
          '2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏™‡πÅ‡∏Å‡∏ô QR" ‡∏´‡∏£‡∏∑‡∏≠ "‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô"<br>' +
          '3. ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏Å PromptPay ID<br>' +
          '4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô' +
          '</div>' +
          '<div style="margin-top: 15px;">' +
          '<button onclick="location.reload()" style="padding: 10px 20px; background: #8b7355; color: white; border: none; border-radius: 6px; cursor: pointer; margin-right: 10px;">‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î QR Code ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>' +
          '<a href="tel:' + PAYMENT_CONFIG.contactPhone.replace(/-/g, '') + '" style="padding: 10px 20px; background: #689f38; color: white; text-decoration: none; border-radius: 6px; display: inline-block;">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: ' + PAYMENT_CONFIG.contactPhone + '</a>' +
          '</div>' +
          '</div>';
      }

      // Generate Thai QR Code for PromptPay
      function generateThaiQRCode(amount, packageName) {
        DEBUG.log('Generating Thai QR Code for amount:', amount, 'package:', packageName);
        DEBUG.log('Using PromptPay ID:', PAYMENT_CONFIG.promptPayId);
        
        const qrContainer = document.getElementById("qrcode");
        qrContainer.innerHTML = '<div style="padding: 20px; text-align: center; color: #8b7355;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code...</div>';
        
        // Validate PromptPay ID
        if (!PAYMENT_CONFIG.promptPayId || PAYMENT_CONFIG.promptPayId.length < 10) {
          DEBUG.warn('‚ö†Ô∏è WARNING: PromptPay ID not configured properly!');
          qrContainer.innerHTML = 
            '<div style="padding: 20px; color: #f57c00; text-align: center; border: 2px dashed #f57c00; border-radius: 8px;">' +
            '‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô<br>' +
            '‡πÇ‡∏ó‡∏£: ' + PAYMENT_CONFIG.contactPhone + '<br>' +
            '<small style="color: #8b7355;">(QR Code ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤)</small>' +
            '</div>';
          return;
        }
        
        // Check if QRCode library is loaded - wait a bit if not ready
        function isQRCodeReady() {
          // Check for qrcodejs (constructor function)
          if (typeof QRCode === 'function') {
            return true;
          }
          // Check for qrcode npm (toCanvas method)
          const qrCode = window.QRCode || window.qrcode || (typeof QRCode !== 'undefined' ? QRCode : null);
          return qrCode && typeof qrCode.toCanvas === 'function';
        }
        
        if (!isQRCodeReady()) {
          DEBUG.warn('QRCode library not loaded yet, waiting...');
          qrContainer.innerHTML = '<div style="padding: 20px; text-align: center; color: #8b7355;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î QR Code Library...</div>';
          
          // Wait for library to load (max 10 seconds)
          let attempts = 0;
          const maxAttempts = 100; // 10 seconds
          const checkQRCode = setInterval(() => {
            attempts++;
            if (isQRCodeReady()) {
              clearInterval(checkQRCode);
              DEBUG.log('QRCode library loaded, generating QR code...');
              // Retry generating QR code
              setTimeout(() => generateThaiQRCode(amount, packageName), 100);
            } else if (attempts >= maxAttempts || window.qrCodeLibraryFailed) {
              clearInterval(checkQRCode);
              DEBUG.error('QRCode library failed to load after 10 seconds');
              // Fallback: Show payment information without QR code
              showPaymentFallback(qrContainer, amount, packageName);
            }
          }, 100);
          return;
        }
        
        const promptPayId = PAYMENT_CONFIG.promptPayId;
        const merchantName = PAYMENT_CONFIG.merchantName;
        
        // THAI_QRCODE Library - JavaScript Implementation
        // Based on https://github.com/suphakin-th/THAI_QRCODE
        // This is a JavaScript port of the Python pypromptpay library
        
        const THAI_QRCODE = (function() {
          'use strict';
          
          // CRC-16/CCITT-FALSE calculation
          // Based on EMV QR Code standard and pypromptpay implementation
          function calculateCRC16(data) {
            let crc = 0xFFFF;
            const polynomial = 0x1021;
            
            // Convert string to bytes for CRC calculation
            for (let i = 0; i < data.length; i++) {
              const byte = data.charCodeAt(i);
              crc ^= (byte << 8);
              
              for (let j = 0; j < 8; j++) {
                if (crc & 0x8000) {
                  crc = ((crc << 1) ^ polynomial) & 0xFFFF;
                } else {
                  crc = (crc << 1) & 0xFFFF;
                }
              }
            }
            
            // Return as 4-digit uppercase hex string
            return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
          }
          
          // Format EMV QR code data object (ID + Length + Value)
          function formatEMVData(id, value) {
            const length = value.length.toString().padStart(2, '0');
            return id + length + value;
          }
          
          // Format PromptPay ID according to Thai QR standard
          // Based on EMV QR Code and PromptPay specification
          // For phone numbers: Tag 01 with value "01130066" + phone number
          // For national ID: Tag 01 with value "01130066" + national ID
          function formatPromptPayID(promptPayId) {
            // Remove any non-digit characters
            const cleanId = promptPayId.replace(/\D/g, '');
            
            // PromptPay uses "01130066" as the prefix for both phone and national ID
            // This is the PromptPay AID (Application Identifier)
            const promptPayPrefix = '01130066';
            
            if (cleanId.length === 10) {
              // Phone number (10 digits) - format: prefix + phone
              return promptPayPrefix + cleanId;
            } else if (cleanId.length === 13) {
              // National ID (13 digits) - format: prefix + national ID
              return promptPayPrefix + cleanId;
            } else if (cleanId.length < 10) {
              // Pad to 10 digits (treat as phone number)
              const paddedId = cleanId.padStart(10, '0');
              return promptPayPrefix + paddedId;
            } else {
              // If longer than 13, use first 13 digits (treat as national ID)
              return promptPayPrefix + cleanId.substring(0, 13);
            }
          }
          
          // Generate Thai QR Code string
          // Parameters:
          //   promptPayId: string - PromptPay ID (phone number or national ID)
          //   amount: number - Transaction amount (will be rounded to integer for THB)
          //   options: object - Optional configuration
          //     - static: boolean - Use static QR (default: false, uses dynamic)
          function generate(promptPayId, amount, options = {}) {
            if (!promptPayId || promptPayId.length < 10) {
              throw new Error('PromptPay ID must be at least 10 digits');
            }
            
            if (!amount || amount <= 0) {
              throw new Error('Amount must be greater than 0');
            }
            
            // For THB currency, use integer amount (no decimals)
            const amountStr = Math.round(amount).toString();
            
            // Format PromptPay ID
            const promptPayValue = formatPromptPayID(promptPayId);
            
            // Build EMV QR Code data
            let qrData = '';
            
            // Payload Format Indicator (00) - Always '01' for EMV QR Code
            qrData += formatEMVData('00', '01');
            
            // Point of Initiation Method (01)
            // '11' = static QR code (no amount)
            // '12' = dynamic QR code (with amount)
            const poiMethod = (options.static || amount === 0) ? '11' : '12';
            qrData += formatEMVData('01', poiMethod);
            
            // Merchant Account Information (38)
            // Contains: GUID (00) + PromptPay ID (01)
            // AID: A000000677010111 (PromptPay)
            const guid = 'A000000677010111';
            const merchantInfo = formatEMVData('00', guid) + formatEMVData('01', promptPayValue);
            qrData += formatEMVData('38', merchantInfo);
            
            // Transaction Currency (53) - THB = 764
            qrData += formatEMVData('53', '0764');
            
            // Transaction Amount (54) - Only include if dynamic QR
            if (poiMethod === '12') {
              qrData += formatEMVData('54', amountStr);
            }
            
            // Country Code (58) - TH = Thailand
            qrData += formatEMVData('58', 'TH');
            
            // Calculate CRC (63)
            // According to EMV QR Code standard:
            // 1. Build data string up to (but not including) CRC field
            // 2. Append CRC field ID and length: "6304"
            // 3. Calculate CRC on this string
            // 4. Append CRC field with calculated value
            const dataForCRC = qrData + '6304';
            const crcValue = calculateCRC16(dataForCRC);
            qrData += formatEMVData('63', crcValue);
            
            // Debug: Log CRC calculation details
            if (typeof DEBUG !== 'undefined' && DEBUG.log) {
              DEBUG.log('CRC Calculation:', {
                dataForCRC: dataForCRC,
                calculatedCRC: crcValue,
                finalQRString: qrData
              });
            }
            
            return qrData;
          }
          
          // Public API
          return {
            generate: generate,
            calculateCRC16: calculateCRC16,
            formatEMVData: formatEMVData,
            formatPromptPayID: formatPromptPayID
          };
        })();
        
        // Generate Thai QR Code using THAI_QRCODE library
        let qrString;
        try {
          qrString = THAI_QRCODE.generate(promptPayId, amount, {
            static: false // Dynamic QR with amount
          });
          
          DEBUG.log('Generated Thai QR Code using THAI_QRCODE library');
          DEBUG.log('QR String:', qrString);
          DEBUG.log('Amount:', Math.round(amount), 'PromptPay ID:', promptPayId);
        } catch (error) {
          DEBUG.error('Error generating Thai QR Code:', error);
          qrContainer.innerHTML = 
            '<div style="padding: 20px; color: #f57c00; text-align: center; border: 2px dashed #f57c00; border-radius: 8px;">' +
            '‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code<br>' +
            error.message + '<br>' +
            '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: ' + PAYMENT_CONFIG.contactPhone +
            '</div>';
          return;
        }
        
        // Clear previous QR code
        qrContainer.innerHTML = "";
        
        // Generate QR code using available library
        try {
          // Check for qrcodejs (davidshimjs) - uses constructor
          if (typeof QRCode === 'function') {
            DEBUG.log('Using qrcodejs library');
            // Create a div for qrcodejs
            const qrDiv = document.createElement('div');
            qrDiv.id = 'qrcode-' + Date.now();
            qrContainer.appendChild(qrDiv);
            
            // Generate QR code with qrcodejs
            new QRCode(qrDiv, {
              text: qrString,
              width: 250,
              height: 250,
              colorDark: '#000000',
              colorLight: '#FFFFFF',
              correctLevel: QRCode.CorrectLevel.M
            });
            
            DEBUG.log('QR Code generated successfully with qrcodejs');
            // Add payment details below QR
            const paymentDetails = document.createElement('div');
            paymentDetails.style.cssText = 'margin-top: 12px; font-size: 12px; color: #8b7355; text-align: center;';
            paymentDetails.innerHTML = `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: <strong>${amount.toLocaleString()} ‡∏ø</strong><br>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô: ${merchantName}`;
            qrContainer.appendChild(paymentDetails);
          }
          // Check for qrcode npm package - uses toCanvas
          else if (typeof QRCode !== 'undefined' && typeof QRCode.toCanvas === 'function') {
            DEBUG.log('Using qrcode npm library');
            const canvas = document.createElement('canvas');
            qrContainer.appendChild(canvas);
            
            QRCode.toCanvas(canvas, qrString, {
              width: 250,
              margin: 2,
              color: {
                dark: '#000000',
                light: '#FFFFFF'
              },
              errorCorrectionLevel: 'M'
            }, function (error) {
              if (error) {
                DEBUG.error('QR Code generation error:', error);
                qrContainer.innerHTML = 
                  '<div style="padding: 20px; color: #8b7355; text-align: center; border: 2px dashed #8b7355; border-radius: 8px;">' +
                  '‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÑ‡∏î‡πâ<br>' +
                  '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: ' + PAYMENT_CONFIG.contactPhone + '<br>' +
                  '<small style="color: #8b7355;">‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</small>' +
                  '</div>';
              } else {
                DEBUG.log('QR Code generated successfully');
                // Add payment details below QR
                const paymentDetails = document.createElement('div');
                paymentDetails.style.cssText = 'margin-top: 12px; font-size: 12px; color: #8b7355; text-align: center;';
                paymentDetails.innerHTML = `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: <strong>${amount.toLocaleString()} ‡∏ø</strong><br>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô: ${merchantName}`;
                qrContainer.appendChild(paymentDetails);
              }
            });
          } else {
            throw new Error('QRCode library not available');
          }
        } catch (err) {
          DEBUG.error('Error generating QR code:', err);
          qrContainer.innerHTML = 
            '<div style="padding: 20px; color: #f57c00; text-align: center; border: 2px dashed #f57c00; border-radius: 8px;">' +
            '‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code<br>' +
            '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: ' + PAYMENT_CONFIG.contactPhone +
            '</div>';
        }
      }

      // Package form submission
      packageForm.addEventListener("submit", (e) => {
        e.preventDefault();
        
        if (!selectedPackage) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡∏Å‡πà‡∏≠‡∏ô");
          return;
        }
        
        if (!paymentVerified) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô");
          return;
        }
        
        const submitBtn = document.getElementById("package-submit-btn");
        submitBtn.disabled = true;
        submitBtn.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";
        
        const formData = new FormData(packageForm);
        const packageData = {
          businessName: formData.get("businessName"),
          businessType: "package", // Special type for package orders
          contactName: formData.get("contactName"),
          email: formData.get("email"),
          phone: formData.get("phone"),
          lineId: formData.get("lineId") || '',
          requirements: formData.get("requirements") || '',
          additionalInfo: formData.get("additionalInfo") || '',
          package: selectedPackage,
          packageName: packageInfo[selectedPackage].displayName,
          packagePrice: packageInfo[selectedPackage].price,
          verifiedAmount: verifiedAmount,
          paymentStatus: "Verified",
          timestamp: new Date().toISOString()
        };
        
        DEBUG.log('Submitting package order:', packageData);
        
        // Send to Google Sheets via Google Apps Script
        fetch(GOOGLE_SCRIPT_URL, {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(packageData),
        })
          .then(() => {
            // Since no-cors mode, we can't read response
            // Show success message
            submitBtn.textContent = "‚úì ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
            submitBtn.style.background = "linear-gradient(135deg, #689f38, #558b2f)";
            
            setTimeout(() => {
              alert("‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠! ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á");
              closePackageModal();
              // Reset state
              paymentVerified = false;
              verifiedAmount = null;
            }, 1000);
          })
          .catch((error) => {
            DEBUG.error("Error submitting package order:", error);
            submitBtn.disabled = false;
            submitBtn.textContent = "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠";
            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: " + PAYMENT_CONFIG.contactPhone);
          });
      });

      // Form submission
      leadForm.addEventListener("submit", (e) => {
        e.preventDefault();
        
        const submitBtn = document.getElementById("submit-btn");
        submitBtn.disabled = true;
        submitBtn.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

        // Collect form data
        const formData = new FormData(leadForm);
        const leadData = {
          businessName: formData.get("businessName"),
          businessType: formData.get("businessType"),
          contactName: formData.get("contactName"),
          email: formData.get("email"),
          phone: formData.get("phone"),
          lineId: formData.get("lineId") || '',
          timestamp: new Date().toISOString()
        };

        // Send to Google Sheets via Google Apps Script
        if (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL !== 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
          // Send data to Google Apps Script
          fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(leadData)
          })
          .then(response => response.json())
          .then(result => {
            DEBUG.log("Lead saved successfully:", result);
            
            // Success - hide form and show template preview
            leadForm.style.display = "none";
            templatePreview.classList.add("active");
            renderTemplate("orders");
            
            // Add template link if available
            if (result.templateUrl) {
              const templateLinkDiv = document.createElement("div");
              templateLinkDiv.style.cssText = "margin-top: 16px; padding: 12px; background: rgba(104, 159, 56, 0.1); border-radius: 8px; border-left: 3px solid #689f38;";
              templateLinkDiv.innerHTML = `
                <div style="font-weight: 600; color: #5d4037; margin-bottom: 8px;">‚úÖ Template Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß!</div>
                <div style="font-size: 12px; color: #8b7355; margin-bottom: 8px;">‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á:</div>
                <a href="${result.templateUrl}" target="_blank" style="display: inline-block; padding: 8px 16px; background: linear-gradient(135deg, #8b7355, #6b5d4f); color: #faf8f3; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 13px;">
                  ‡πÄ‡∏õ‡∏¥‡∏î Google Sheets Template
                </a>
              `;
              templatePreview.insertBefore(templateLinkDiv, templatePreview.firstChild.nextSibling);
            }
            
            // Scroll to template
            templatePreview.scrollIntoView({ behavior: "smooth", block: "start" });
            
            submitBtn.disabled = false;
            submitBtn.textContent = "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
          })
          .catch((error) => {
            DEBUG.error("Error submitting lead:", error);
            // Still show template even if there's an error
            leadForm.style.display = "none";
            templatePreview.classList.add("active");
            renderTemplate("orders");
            templatePreview.scrollIntoView({ behavior: "smooth", block: "start" });
            
            submitBtn.disabled = false;
            submitBtn.textContent = "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
            
            // Show error message but don't block the user
            console.warn("Note: There was an error saving to Google Sheets, but template is still shown");
          });
        } else {
          // Fallback if URL not configured - still show template
          DEBUG.log("Lead captured (not sent to Google Sheets - URL not configured):", leadData);
          DEBUG.warn("Please configure GOOGLE_SCRIPT_URL in the JavaScript code");
          
          // Hide form and show template preview
          leadForm.style.display = "none";
          templatePreview.classList.add("active");
          renderTemplate("orders");
          
          // Scroll to template
          templatePreview.scrollIntoView({ behavior: "smooth", block: "start" });
          
          submitBtn.disabled = false;
          submitBtn.textContent = "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
        }
      });
    </script>
  </body>
</html>
